# ✏️ 스터디 기록

> 스터디 일시 : 2023.02.14  
> 서기: beenz

<br />

## 11장. 쿼리 작성 및 최적화


<br />

### 학습 내용

---
- DDL 8.0버전부터 온라인 DDL 이 가능해졌다.
- 온라인 DDL의 알리즘에는 `INSTANT`, `INPLACE`, `COPY` 알고리즘이 있다.
- 잠금수준에는 `NONE`, `SHARED`, `EXCLUSIVE` 가 있다.
- INSTANCT 알고리즘과 달리 INPLACE 알고리즘은 실패할 수 있는 확률이 생긴다. (최대한 온라인 DDL 실패 가능성을 낮추는것이 좋다.)
- 온라인 DDL은 `performance_schema`을 통해 모니터링을 할 수 있다.
- 테이블 변경시 ENGINE 옵션을 넣으면 임시테이블을 생성하여 모든 테이블을 복사하는 작업이 실행된다. (기존과 동일하더라도)
- 배치 수행중 RENAME 시 찰나의 순간에 테이블이 없어지는 순간이 생길 수 있어 주의할것
- 테이블 구조 복사시 `CREATE TABLE LIKE` 명령어를 통해 인덱스까지 복사할 수 있다.
- 용량이 큰 테이블 삭제 작업은 부하가 큰 작업이니 서비스 도중에는 수행 X
- 테이블 컬럼 사이즈를 확장/축소할 때 리빌딩이 되는 것에 주의하여 알고리즘을 사용하자.
- 전문 검색 인덱스, 공간검색 인덱스는 SHARED 잠금이 필요하다.
- 인덱스 이름 변경 및 가시성 변경 삭제를 할 수 있다.
- `SHOW PROCESSLIST` 명령어로 사용자 목록이나 클라이언트 실행 쿼리를 확인할 수 있다.
- `information_schema.INNODB_TRX` 테이블을 통해 활성 트랜잭션을 조회할 수 있다.
- InnoDB → 버퍼풀이 캐시 기능을 담당, MyISAM → 키 캐시가 캐시기능을 담당
- MySQL 서버는 독립된 서버로 구성할 것을 권장한다.

### Issue

--- 

- 

### 질문

---
- 스키마와 메타데이터의 차이  
  → 스키마는 데이터베이스의 레이아웃입니다. 예: 테이블 필드, 정의, 페이지, 행 및 열 등  
  → 메타 데이터는 데이터베이스에 대한 데이터입니다. 예를 들어 모든 랩 음악에 대한 데이터가 있는 경우 메타 데이터는 저자, 트랙 수, 출시 연도, 위치, 앨범 이름 등입니다.

- 온라인 DDL 모니터링이 수행이 안되는 문제 (p175)
- 어댑티브 해시 인덱스 정보를 어떻게 삭제하는지. (p191)  
  → 테이블 삭제시 내부적으로 어댑티브 해시 인덱스도 삭제해야하기 때문에 MySQL 서버 부하가 높아진다.
    > 💡 어댑티브 해시 인덱스 란?  
      → 자주 읽히는 데이터 페이지의 키 값으로 인덱스를 만들고, 어댑티브 해시 인덱스로 검색한다.
- ```MySQL
  RENAME TABLE db1.table1 TO db2.table2;
  ```
  다른 파티션간 위 명령어 수행시 원본테이블이 삭제되는 것인지? (p185)  
  → 맞다. 데이터파일을 이동하는 것과 `RENAME` 명령어와 내부적으로 동일한 원리라는 말씀!


## 다음주 공지
✔️ 다음주부터 토요일로 변경  
✔️ 2.25(토) 08:00
